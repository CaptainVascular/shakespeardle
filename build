#!/bin/bash

cd  "$(dirname "$0")"
DIR="$PWD"

[ -d 'dist' ] && rm -rf dist
mkdir dist

cd "$DIR/parser"
[ -d 'node_modules' ] || npm i
[ -d 'dist' ] && rm -rf dist
npx tsc && node dist

cd "$DIR/client"
[ -d 'node_modules' ] || npm i
npx pug -P -o ../dist index.pug
npx sass scss/index.scss ../dist/index.css
npx webpack

cd "$DIR"
cp -r assets dist/
